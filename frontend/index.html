<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>swch</title>
    <link rel="stylesheet" href="src/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="logo"><i class="fa-solid fa-repeat"></i> SWCH</div>
            
            <div class="nav-item active" onclick="switchTab('library')">
                <i class="fa-solid fa-gamepad"></i> Library
            </div>
            <div class="nav-item" onclick="switchTab('accounts')">
                <i class="fa-solid fa-users"></i> Accounts
            </div>
            
            <div class="nav-spacer"></div>
            <div class="nav-item action-btn" onclick="openAddGameModal()">
                <i class="fa-solid fa-plus"></i> Add Game
            </div>
            <div class="nav-item action-btn" onclick="openAddAccountModal()" style="margin-top: 10px; background-color: #444;">
                <i class="fa-solid fa-user-plus"></i> Add Account
            </div>
            </aside>

        <main class="main-content">
            <div id="view-library" class="view-section">
                <div class="header"><div class="title">Library</div></div>
                
                <div id="library-filters" class="filters-container">
                    <div class="search-wrapper">
                        <i class="fa-solid fa-magnifying-glass search-icon"></i>
                        <input type="text" id="filter-search" placeholder="Поиск по названию..." class="input-field search-input" oninput="applyFilters()">
                    </div>

                    <div class="filter-group">
                        <button class="filter-tag active" onclick="toggleFilter(this, 'Steam')" data-type="platform">
                            <i class="fa-brands fa-steam"></i> Steam
                        </button>
                        <button class="filter-tag active" onclick="toggleFilter(this, 'Epic')" data-type="platform">
                            <i class="fa-solid fa-bolt"></i> Epic
                        </button>
                        <button class="filter-tag active" onclick="toggleFilter(this, 'Riot')" data-type="platform">
                            <i class="fa-solid fa-gamepad"></i> Riot
                        </button>
                        <button class="filter-tag active" onclick="toggleFilter(this, 'Custom')" data-type="platform">
                            <i class="fa-solid fa-folder"></i> Custom
                        </button>
                    </div>

                    <div class="filter-group right">
                        <button class="filter-tag" id="filter-installed" onclick="toggleBooleanFilter(this)">
                            <i class="fa-solid fa-download"></i> Только скачанные
                        </button>
                        <button class="filter-tag" id="filter-macos" onclick="toggleBooleanFilter(this)">
                            <i class="fa-brands fa-apple"></i> macOS
                        </button>
                    </div>
                </div>

                <div class="grid" id="games-grid"></div>
            </div>

            <div id="view-accounts" class="view-section" style="display: none;">
                <div class="header"><div class="title">Accounts</div></div>
                <div id="launchers-list"></div>
            </div>
        </main>
    </div>

    <div id="account-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modal-game-title">Launch</h3>
                <span class="close" onclick="closeModal('account-modal')">&times;</span>
            </div>
            <div id="modal-accounts-list" class="modal-list"></div>
            <div class="modal-footer-options">
                <label style="cursor:pointer; display:flex; align-items:center;">
                    <input type="checkbox" id="show-hidden-accs" onchange="refreshGameModal()" style="margin-right:8px;"> 
                    Show removed accounts
                </label>
            </div>
        </div>
    </div>

    <div id="note-select-modal" class="modal" style="z-index: 2000;">
        <div class="modal-content" style="max-width: 300px;">
            <div class="modal-header">
                <h3>Account Tag</h3>
                <span class="close" onclick="closeModal('note-select-modal')">&times;</span>
            </div>
            <div style="padding: 20px;">
                <div style="display: flex; gap: 10px; margin-bottom: 15px;">
                    <button class="sticker-btn btn-main" onclick="savePredefinedNote('Main')"><i class="fa-solid fa-crown"></i> MAIN</button>
                    <button class="sticker-btn btn-smurf" onclick="savePredefinedNote('Smurf')"><i class="fa-solid fa-child"></i> SMURF</button>
                    <button class="sticker-btn btn-vac" onclick="savePredefinedNote('VAC')"><i class="fa-solid fa-ban"></i> VAC</button>
                </div>
                <div style="border-top: 1px solid #444; padding-top: 15px;">
                    <input type="text" id="custom-note-input" placeholder="Or type custom note..." class="input-field" style="width:100%; box-sizing:border-box; padding:10px; background:#222; border:1px solid #444; color:white; margin-bottom:10px;">
                    <button onclick="saveCustomNote()" style="width:100%; padding:8px; background:#0074e4; border:none; color:white; cursor:pointer;">Save Text</button>
                </div>
                <button class="sticker-btn btn-clear" onclick="savePredefinedNote('')"><i class="fa-solid fa-eraser"></i> Clear Tag</button>
            </div>
        </div>
    </div>

    <div id="edit-account-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Edit Account Details</h3>
                <span class="close" onclick="closeModal('edit-account-modal')">&times;</span>
            </div>
            <div style="padding: 20px;">
                <label style="color:#aaa; font-size:12px;">Comment:</label>
                <input type="text" id="edit-comment" class="input-field" style="width:100%; margin-bottom:15px; padding:10px; background:#333; border:none; color:white;">
                <label style="color:#aaa; font-size:12px;">Custom Avatar:</label>
                <div style="display:flex; gap:10px;">
                    <input type="text" id="edit-avatar-path" class="input-field" style="flex:1; padding:10px; background:#333; border:none; color:white;" readonly>
                    <button onclick="selectNewAvatar()" style="padding:10px 15px; background:#0074e4; border:none; color:white; cursor:pointer;">Browse</button>
                </div>
                <button onclick="saveAccountChanges()" style="width:100%; margin-top:20px; padding:10px; background:#2d8c58; border:none; color:white; cursor:pointer; font-weight:bold;">Save Changes</button>
            </div>
        </div>
    </div>

    <div id="add-game-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add Non-Steam Game</h3>
                <span class="close" onclick="closeModal('add-game-modal')">&times;</span>
            </div>
            <div style="padding: 20px;">
                <input type="text" id="custom-name" placeholder="Game Name" class="input-field" style="width:100%; margin-bottom:10px; padding:10px; background:#333; border:none; color:white;">
                <div style="display:flex; gap:10px;">
                    <input type="text" id="custom-path" placeholder="Path to .exe" class="input-field" style="flex:1; padding:10px; background:#333; border:none; color:white;" readonly>
                    <button onclick="browseFile()" style="padding:10px 15px; background:#0074e4; border:none; color:white; cursor:pointer;">Browse</button>
                </div>
                <button onclick="saveCustomGame()" style="width:100%; margin-top:20px; padding:10px; background:#2d8c58; border:none; color:white; cursor:pointer; font-weight:bold;">Add to Library</button>
            </div>
        </div>
    </div>

    <div id="save-epic-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Save Current Epic Account</h3>
                <span class="close" onclick="closeModal('save-epic-modal')">&times;</span>
            </div>
            <div style="padding: 20px;">
                <p style="color:#aaa; font-size:13px; margin-bottom:15px;">Make sure you are currently logged into Epic.</p>
                <input type="text" id="epic-save-name" placeholder="Account Name" class="input-field" style="width:100%; margin-bottom:10px; padding:10px; background:#333; border:none; color:white;">
                <button onclick="doSaveEpic()" style="width:100%; margin-top:10px; padding:10px; background:#0074e4; border:none; color:white; cursor:pointer; font-weight:bold;">Save Profile</button>
            </div>
        </div>
    </div>

    <div id="add-account-modal" class="modal">
        <div class="modal-content" style="max-width: 400px;">
            <div class="modal-header">
                <h3>Add New Account</h3>
                <span class="close" onclick="closeModal('add-account-modal')">&times;</span>
            </div>
            <div style="padding: 20px; display: flex; flex-direction: column; gap: 15px;">
                <button onclick="startLegendaryLogin()" class="btn-main" style="padding:15px; background:#000; color:white; border:1px solid #444; cursor:pointer; display:flex; align-items:center; gap:10px;">
                    <i class="fa-solid fa-terminal"></i> 
                    <div style="text-align:left;">
                        <div style="font-weight:bold;">Legendary (Epic CLI)</div>
                        <div style="font-size:11px; color:#aaa;">Login via Browser/Terminal</div>
                    </div>
                </button>
                
                <button onclick="openEpicSaveModal(); closeModal('add-account-modal')" class="btn-main" style="padding:15px; background:#333; color:white; border:none; cursor:pointer; display:flex; align-items:center; gap:10px;">
                    <i class="fa-solid fa-bolt"></i>
                    <div style="text-align:left;">
                        <div style="font-weight:bold;">Epic Games Launcher</div>
                        <div style="font-size:11px; color:#aaa;">Save CURRENT logged in session</div>
                    </div>
                </button>

                <button onclick="openRiotSaveModal(); closeModal('add-account-modal')" class="btn-main" style="padding:15px; background:#d13639; color:white; border:none; cursor:pointer; display:flex; align-items:center; gap:10px;">
                    <i class="fa-solid fa-gamepad"></i>
                    <div style="text-align:left;">
                        <div style="font-weight:bold;">Riot Games Client</div>
                        <div style="font-size:11px; color:#aaa;">Save CURRENT logged in session</div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <div id="save-legendary-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Save Current Legendary Session</h3>
                <span class="close" onclick="closeModal('save-legendary-modal')">&times;</span>
            </div>
            <div style="padding: 20px;">
                <p style="color:#aaa; font-size:13px; margin-bottom:15px;">
                    1. Login via "Add Account" -> "Legendary" first.<br>
                    2. Come back here and save the session.
                </p>
                <input type="text" id="legendary-save-name" placeholder="Account Name (e.g. MyEpicAcc)" class="input-field" style="width:100%; margin-bottom:10px; padding:10px; background:#333; border:none; color:white;">
                <button onclick="doSaveLegendary()" style="width:100%; margin-top:10px; padding:10px; background:#000; border:1px solid #444; color:white; cursor:pointer; font-weight:bold;">Save Profile</button>
            </div>
        </div>
    </div>

    <div id="save-riot-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Save Current Riot Account</h3>
                <span class="close" onclick="closeModal('save-riot-modal')">&times;</span>
            </div>
            <div style="padding: 20px;">
                <p style="color:#aaa; font-size:13px; margin-bottom:15px;">Make sure you are currently logged into Riot Client.</p>
                <input type="text" id="riot-save-name" placeholder="Account Name (e.g. Main)" class="input-field" style="width:100%; margin-bottom:10px; padding:10px; background:#333; border:none; color:white;">
                <button onclick="doSaveRiot()" style="width:100%; margin-top:10px; padding:10px; background:#d13639; border:none; color:white; cursor:pointer; font-weight:bold;">Save Profile</button>
            </div>
        </div>
    </div>
    <div id="context-menu" class="context-menu">
        <ul>
            <li id="ctx-change-icon" class="ctx-item">Изменить иконку</li>
            <li id="ctx-delete" class="ctx-item delete">Удалить игру</li>
        </ul>
    </div>
    
    <script src="/wailsjs/go/app/App.js"></script>
    <script type="module" src="src/main.js"></script>
</body>
</html>